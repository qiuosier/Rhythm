{% extends "nest/base.html" %}
{% block content %}
<div id="myCarouselWrapper" class="row">
    <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="6000">
        <ol class="carousel-indicators">
            {% for i in carousel_data %}
            {% if forloop.counter == 1 %}
            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
            {% else %}
            <li data-target="#myCarousel" data-slide-to="{{ forloop.counter0 }}"></li>
            {% endif %}
            {% endfor %}
        </ol>
        <div class="carousel-inner" role="listbox">
            {% for entry in carousel_data %}
            {% if forloop.counter == 1 %}
            <div class="item active">
            {% else %}
            <div class="item">
            {% endif %}
            <img src="{{ entry.image }}" alt="" class="img-responsive" />
                <div class="carousel-caption">
                    <p>
                        {{ entry.key }} - {{ entry.description}} <br />
                        <small>Photo by Qiu, {{ entry.date }}</small>
                    </p>
                    <a class="btn btn-default btn-default btn-sm" href="{{ entry.link }}">
                        Learn More
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
<div id="myBirds" class="row">
    {% for bird in birds %}
    <div class="col-md-3 col-xs-6 bird-rectangle text-center">
        <div class="bird-logo-wrapper">
            <a href="{{ bird.link }}"><img class="bird-logo img-circle fade" src="{{ bird.image }}" /></a>
        </div>
        <a href="{{ bird.link }}">
            <h4>
                {{ bird.name }} | {{ bird.description }}
            </h4>
        </a>
    </div>
    {% endfor %}
</div>

<script>
    $(document).ready(function () {
        fluidContainer();
        // set image wraper initial height
        var imageHeight = $('.navbar').outerWidth() * 700 / 1920 / 3;
        $("#myCarouselWrapper").css({
            'height': imageHeight + 'px'
        });
        $("#myBirds").fadeIn(800);
    });

    $(window).resize(function () {
        fluidContainer();
        setImageHeight();
    });

    $(window).ready(function () {
        // Slide down and fade in
        setTimeout(function () {
            // Animate image height
            // Mininum height is set to 280px in css.
            var imageHeight = Math.max(280, $('.navbar').outerWidth() * 700 / 1920);
            $("#myCarouselWrapper").animate({
                height: imageHeight + 'px'
            }, 1000, function () {
                $("#myCarousel").animate({
                    opacity: "1"
                }, 1000);
            });
        }, 1000);
    })

    function fluidContainer() {
        // Override the width of the container in the layout template
        // Credits: http://jsfiddle.net/iamnotsam/E3RQp/1/
        var $c = $('.container'),
            $w = $('#myCarouselWrapper'),
            totalWidth = $('.navbar').outerWidth(),
            wellWidth = $c.outerWidth(),
            diff = totalWidth - wellWidth,
            marg = -Math.floor(diff / 2) - 10  + 'px';
        $w.each(function () {
            $(this).css({
                'margin-left': marg,
                'margin-right': marg
            });
        })
    }

    function setImageHeight() {
        // Set the height of the carousel image.
        // Mininum height is set to 280px in css.
        var imageHeight = Math.max(280, $('.navbar').outerWidth() * 700 / 1920);
        $("#myCarouselWrapper").css({
            'height': imageHeight + 'px'
        })
    }

</script>

{% endblock %}